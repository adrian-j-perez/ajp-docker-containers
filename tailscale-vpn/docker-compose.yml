# tailscale to set a tunnel into local network

# https://tailscale.com/kb/1282/docker

services:
  tailscale:
    image: tailscale/tailscale:latest
    hostname: ts-docker
    environment:
      #  gen auth key from website
      - TS_AUTHKEY=tskey-auth-xxxxxx
      - TS_EXTRA_ARGS=--advertise-tags=tag:container # adding tags
      - TS_STATE_DIR=/var/lib/tailscale
      - TS_USERSPACE=false
      - TS_ROUTES=10.0.0.0/24 # setting routes
    volumes:
      # this is how ts will remember is state data
      - ./ts/state:/var/lib/tailscale
    devices:
      - /dev/net/tun:/dev/net/tun
    cap_add:
      - net_admin
      - sys_module
    restart: always
